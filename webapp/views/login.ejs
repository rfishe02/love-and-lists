<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Love & Lists | Login</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN"
      crossorigin="anonymous"
    />
    <style>
      button {
        width: 100px;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <div class="row justify-content-center" style="margin-top: 100px">
        <div class="col-6">
          <form id="form">
            <div class="mb-3">
              <label for="exampleInputEmail1" class="form-label"
                >Email address</label
              >
              <input
                type="email"
                name="email"
                class="form-control"
                id="email"
                aria-describedby="emailHelp"
              />
              <!--<div id="emailHelp" class="form-text">We'll never share your email with anyone else.</div>-->
            </div>
            <div class="mb-3">
              <label for="exampleInputPassword1" class="form-label"
                >Password</label
              >
              <input
                type="password"
                name="password"
                class="form-control"
                id="password"
              />
            </div>
            <button type="button" onclick="signUp()" class="btn btn-secondary">
              Sign Up
            </button>
            <button type="button" onclick="login()" class="btn btn-primary">
              Log In
            </button>
          </form>
        </div>
      </div>
    </div>

    <script>
      const email = document.getElementById("email");
      const password = document.getElementById("password");

      function signUp() {
        const data = { email: email.value, password: password.value };

        try {
          fetch(window.location.origin + "/auth/signup", {
            method: "post",
            headers: {
              "Content-Type": "application/x-www-form-urlencoded",
            },
            body: new URLSearchParams(data),
          })
            .then((response) => response.json())
            .then((data) => {
              const redirectUrl = data.redirectUrl;
              window.location.href = redirectUrl;
            })
            .catch((error) => {
              console.error("Fetch error:", error);
            });
        } catch (err) {
          alert("Signup attempt failed.");
        }
      }

      function login() {
        console.log("login");

        const data = { email: email.value, password: password.value };

        try {
          fetch(window.location.origin + "/auth/login", {
            method: "post",
            headers: {
              "Content-Type": "application/x-www-form-urlencoded",
            },
            body: new URLSearchParams(data),
          })
            .then((response) => response.json())
            .then((data) => {
              const redirectUrl = data.redirectUrl;
              window.location.href = redirectUrl;
            })
            .catch((error) => {
              console.error("Fetch error:", error);
            });
        } catch (err) {
          alert("Signup attempt failed.");
        }
      }
    </script>
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL"
      crossorigin="anonymous"
    ></script>
  </body>
</html>
